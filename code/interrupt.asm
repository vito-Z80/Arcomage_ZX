	module	IM
INT_    equ     #FC00

interrupt:
        push hl,de,bc,af,ix,iy
        exx 
        exa
        push hl,de,bc,af
	
        pop af,bc,de,hl
        exa
        exx
        pop iy,ix,af,bc,de,hl
        ei
        ret
im2_init:
        ld hl,INT_
        ld a,h
        di
        ld i,a
        inc a
        ld c,a
        ld b,l
.loop:
        ld (hl),c
        inc hl
        djnz .loop
        ld (hl),c
        ld h,c
        ld l,h
        ld (hl),#C3
        inc l
        ld (hl),low interrupt
        inc l
        ld (hl),high interrupt
        im 2
        ei
        ret
/////////////////////////////////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////
	endmodule